@{
    Layout = "~/Views/Shared/_LayoutMain.cshtml";
    ViewBag.Title = "Vacantes - Prácticas";
}
<h2 class="vacantes-titulo titulo-principal d-flex justify-content-center align-items-center">
    Proceso de Aplicación - Ariana Fallas Calderón
</h2>

<div class="d-flex flex-wrap justify-content-between" style="gap: 2rem;">
    <!-- Columna Izquierda: Información General -->
    <div class="card p-4 shadow mb-4" style="flex: 1 1 48%;">
        <div class="row mb-3">
            <h3 class="section-title">Información General</h3>

        </div>
        <div class="row g-4 justify-content-between">

            <!-- Columna de Vacante -->
            <div class="col-md-6">
                <div class="card shadow-sm p-3" style="border-radius: 12px; background-color: #F9F9F9;">
                    <h5 class="mb-3" style="color: #2D594D;"><strong>Información de Vacante</strong></h5>
                    <div class="mb-2">
                        <label class="form-label text-muted"><strong>Nombre</strong></label><br />
                        <span>Internship IT Asset Management</span>
                    </div>
                    <div class="mb-2">
                        <label class="form-label text-muted"><strong>Empresa</strong></label><br />
                        <span>Boston Scientific</span>
                    </div>
                    <div class="mb-2">
                        <label class="form-label text-muted"><strong>Requerimientos</strong></label><br />
                        <span>Inglés B1, conocimientos en Active Directory</span>
                    </div>
                    <div class="mb-2">
                        <label class="form-label text-muted"><strong>Fecha de Aplicación</strong></label><br />
                        <span>15-07-2025</span>
                    </div>
                    <div class="mb-2">
                        <label class="form-label text-muted"><strong>Modalidad</strong></label><br />
                        <span>Híbrido</span>
                    </div>
                </div>
            </div>

            <!-- Columna de Estudiante -->
            <div class="col-md-6">
                <div class="card shadow-sm p-3" style="border-radius: 12px; background-color: #F9F9F9;">
                    <h5 class="mb-3" style="color: #2D594D;"><strong>Información del Estudiante</strong></h5>
                    <div class="mb-2">
                        <label class="form-label text-muted"><strong>Nombre</strong></label><br />
                        <span>Ariana Fallas Calderón</span>
                    </div>
                    <div class="mb-2">
                        <label class="form-label text-muted"><strong>Cédula</strong></label><br />
                        <span>123456789</span>
                    </div>
                    <div class="mb-2">
                        <label class="form-label text-muted"><strong>Correo</strong></label><br />
                        <span>afallas@email.com</span>
                    </div>
                    <div class="mb-2">
                        <label class="form-label text-muted"><strong>Especialidad</strong></label><br />
                        <span>Informática Empresarial</span>
                    </div>
                    <div class="mb-2">
                        <label class="form-label text-muted"><strong>Edad</strong></label><br />
                        <span>17 años</span>
                    </div>
                </div>
            </div>

        </div>


        <hr />

        <h3 class="section-title">Información de Contacto</h3>
        <div class="mb-2"><label style="color: #2D594D"><strong>Contacto en la empresa</strong></label><br /><span>Kimberly Rojas Sánchez</span></div>
        <div class="mb-2"><label style="color: #2D594D"><strong>Email</strong></label><br /><span>krojas@ejemplo.com</span></div>
        <div class="mb-2"><label style="color: #2D594D"><strong>Teléfono</strong></label><br /><span>88888888</span></div>
    </div>

    <!-- Columna Derecha: Proceso de Aplicación -->
    <div class="card p-4 shadow mb-4" style="flex: 1 1 48%;">
        <h3 class="section-title">Proceso de Aplicación</h3>
        <h4 style="color: #2D594D; font-weight: 600;">Comentarios del Proceso</h4>
        <hr />

        <!-- Comentarios -->
        <div id="comentariosAnteriores">
            <ul class="list-unstyled">
                <li>
                    <strong>03/08/2025 - Ariana Fallas:</strong><br />
                    Enviada documentación al correo de Kimberly.
                </li>
                <li>
                    <strong>01/08/2025 - Admin:</strong><br />
                    Se notificó a la estudiante sobre entrevista.
                </li>
                <li>
                    <strong>30/07/2025 - Kimberly Rojas:</strong><br />
                    La vacante aún está abierta, pero se evaluará el perfil.
                </li>
            </ul>
        </div>

        <!-- Estado -->
        <div class="mt-4">
            <h4 style="color: #2D594D; font-weight: 600;">Estado Actual</h4>
            <span class="badge badge-asignada">En Progreso</span>
        </div>

        <!-- Botones -->
        <div class="mt-4 action-buttons">
            <div class="row top-buttons">
                <div class="col-md-6">
                    <button type="button" class="btn-verde-personalizado w-100" data-bs-toggle="modal" data-bs-target="#modalAgregarComentario">
                        Agregar Comentario
                    </button>
                </div>
                <div class="col-md-6">
                    <button type="button" class="btn-verde-personalizado w-100" data-bs-toggle="modal" data-bs-target="#modalActualizarEstado">
                        Actualizar Estado
                    </button>
                </div>
            </div>
        </div>
        <!--MODAL PARA ACTUALIZAR ESTADO-->
        <div class="modal fade" id="modalActualizarEstado" tabindex="-1" aria-labelledby="modalCrearVacanteLabel" aria-hidden="true">
            <div class="modal-dialog modal-lg modal-dialog-scrollable">
                <div class="modal-content" style="border-radius: 12px; background-color: #F2F2F2; color: #2D594D;">

                    <!-- HEADER -->
                    <div class="modal-header" style="background-color: #2D594D; color: white;">
                        <h5 class="modal-title">Nueva Vacante para Práctica</h5>
                        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Cerrar"></button>
                    </div>

                    <div class="modal-body px-4">


                        <form id="formActualizarEstado">
                            <div class="mb-3">
                                <label for="nuevoEstado" class="form-label" style="font-size: 14px">Nuevo Estado</label>
                                <select id="nuevoEstado" name="nuevoEstado" style="font-size: 14px" class="form-select" required>
                                    <option value="">Seleccione un estado</option>
                                    <option value="En progreso">En progreso</option>
                                    <option value="Completado">Aceptado</option>
                                    <option value="Rechazado">Rechazado</option>
                                    <option value="Cancelado">Cancelado</option>
                                    <option value="Asignado">Asignado</option>
                                </select>
                            </div>
                            <div class="mb-3">
                                <label for="comentarioEstado" class="form-label">Comentario</label>
                                <textarea id="comentarioEstado" name="comentarioEstado" class="form-control" rows="4" placeholder="Agrega un comentario sobre esta actualización..."></textarea>
                            </div>
                            <div class="text-end">
                                <button type="submit" class="btn-verde-personalizado" id="BtnActualizarEstado">Actualizar</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>

        <div class="modal fade" id="modalAgregarComentario" tabindex="-1" aria-labelledby="modalCrearVacanteLabel" aria-hidden="true">
            <div class="modal-dialog modal-lg modal-dialog-scrollable">
                <div class="modal-content" style="border-radius: 12px; background-color: #F2F2F2; color: #2D594D;">

                    <!-- HEADER -->
                    <div class="modal-header" style="background-color: #2D594D; color: white;">
                        <h5 class="modal-title">Comentarios</h5>
                        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Cerrar"></button>
                    </div>

                    <div class="modal-body px-4">


                        <form id="formAgregarComentario">

                            <div class="mb-3">
                                <label for="comentarioEstado" class="form-label">Comentario</label>
                                <textarea id="ComentarioProceso" name="comentarioEstado" class="form-control" rows="4"  placeholder="Agrega un comentario sobre el proceso de postulación.."></textarea>
                            </div>
                            <div class="text-end">
                                <button type="submit" class="btn-verde-personalizado" id="BtnAgregarComentario">Agregar</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>

    </div>
</div>

@section Scripts {
    <script>
        $(document).ready(function () {
            $("#BtnActualizarEstado").on("click", function (event) {
               // Evita el envío automático del formulario

                let comentarioInput = $("#comentarioEstado");

                event.preventDefault();

                let comentario = comentarioInput.val().trim();

                if (comentario === "") {

                    Swal.fire({
                        icon: "warning",
                        title: "Comentario requerido",
                        text: "Debes escribir un comentario antes de actualizar el estado.",
                        confirmButtonColor: "#2D594D"
                    });

                    comentarioInput.focus();
                    return;
                } else {

                    Swal.fire({
                        icon: "success",
                        title: "Proceso actualizado",
                        text: "Proceso de aplicación actualizado correctamente.",
                        confirmButtonColor: "#2D594D"
                    }).then(() => {
                         window.location.href = '@Url.Action("VisualizacionPostulacion", "Practicas")';
                    });
                }
            });

             $("#BtnAgregarComentario").on("click", function (event) {
    
     let comentarioInput = $("#ComentarioProceso");

     event.preventDefault();

     let comentario = comentarioInput.val().trim();

     if (comentario === "") {

         Swal.fire({
             icon: "warning",
             title: "Comentario requerido",
             text: "Debes escribir un comentario antes de continuar.",
             confirmButtonColor: "#2D594D"
         });

         comentarioInput.focus();
         return;
     } else {

         Swal.fire({
             icon: "success",
             title: "Comentario",
             text: "Comentario agregado correctamente.",
             confirmButtonColor: "#2D594D"
         }).then(() => {
              window.location.href = '@Url.Action("VisualizacionPostulacion", "Practicas")';
         });
     }
 });
        });
    </script>
}
