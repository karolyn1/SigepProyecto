@{
    ViewBag.Title = "Lista de Egresados";
    Layout = "~/Views/Shared/_LayoutMain.cshtml";
}

    <h2 class="vacantes-titulo titulo-principal">Lista de Egresados</h2>

    <div class="acciones-superiores p-3">


        <div class="exportar">
            <button id="btnExportarExcel" class="btn-cta btn-nuevo">Exportar Excel</button>
            <button id="btnExportarPDF" class="btn-cta btn-nuevo">Exportar PDF</button>
        </div>
        <div class="filtros row">
            <div class="col">
                <label for="filtroEspecialidad">Especialidad:</label>

                <select id="filtroEspecialidad" class="form-control">
                    <option value="">Todas</option>
                    <option value="Informática">Informática</option>
                    <option value="Administración">Administración</option>
                    <!-- Agrega más opciones según tus datos -->
                </select>
            </div>
            <div class="col">
                <label for="filtroAnio" style="margin-left: 20px;">Año:</label>
                <select id="filtroAnio" class="form-control">
                    <option value="">Todos</option>
                    <option value="2022">2022</option>
                    <option value="2023">2023</option>
                    <option value="2024">2024</option>
                    <!-- Más años -->
                </select>

            </div>

           
        </div>
    </div>
    <div class="card rounded-5 p-3">
        <table id="miTabla" class="display responsive nowrap w-100">
            <thead>
                <tr>
                    <th>Nombre completo</th>
                    <th>Generación</th>
                    <th>Especialidad</th>
                    <th>Correo</th>
                    <th>Teléfono</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Ana Morales Campos</td>
                    <td>2022</td>
                    <td>Informática</td>
                    <td>ana.morales@email.com</td>
                    <td>8888-1111</td>
                </tr>
                <tr>
                    <td>Kevin Rojas León</td>
                    <td>2023</td>
                    <td>Administración</td>
                    <td>kevin.rojas@email.com</td>
                    <td>8777-2222</td>
                </tr>
                <!-- Más filas dinámicas -->
            </tbody>
        </table>
    </div>
</section>

<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.5/xlsx.full.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>

@section Scripts {
    <script src="~/Scripts/validaciones.js"></script>

    <script>
        $(document).ready(function () {
            $("#filtroEspecialidad, #filtroAnio").on("change", function () {
                let especialidad = $("#filtroEspecialidad").val().toLowerCase();
                let anio = $("#filtroAnio").val();

                $("#miTabla tbody tr").each(function () {
                    let fila = $(this);
                    let esp = fila.find("td:eq(2)").text().toLowerCase();
                    let gen = fila.find("td:eq(1)").text();

                    let coincideEsp = !especialidad || esp === especialidad;
                    let coincideAnio = !anio || gen === anio;

                    if (coincideEsp && coincideAnio) {
                        fila.show();
                    } else {
                        fila.hide();
                    }
                });
            });

            document.getElementById("btnExportarExcel").addEventListener("click", function () {
                let wb = XLSX.utils.table_to_book(document.getElementById("miTabla"), { sheet: "Egresados" });
                XLSX.writeFile(wb, "Lista_Egresados.xlsx");
            });

            document.getElementById("btnExportarPDF").addEventListener("click", function () {
                const { jsPDF } = window.jspdf;
                const doc = new jsPDF();
                doc.text("Lista de Egresados", 14, 15);
                doc.autoTable({ html: '#miTabla', startY: 20 });
                doc.save("Lista_Egresados.pdf");
            });
        });
    </script>
}